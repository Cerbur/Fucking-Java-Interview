# MySQL事务隔离

当数据库上多个事务同时执行的时候，可能出现脏读、不可重复度、幻读等问题这就又了事务隔离等概念。

SQL标准的事务隔离级别包括：读未提交（read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（serializable ）。

- 读未提交是指，一个事务还没提交时，它做的变更就能被别的事务看到。
- 读提交是指，一个事务提交之后，它做的变更才会被其他事务看到。
- 可重复读是指，一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的。
- 串行化，顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。 



## 事务隔离的实现

#### MVCC

![](https://raw.githubusercontent.com/Cerbur/pic/main/20210715020033.png)

InnoDB 会在 undo log 中形成一个版本链，在对应隔离级别下生成对应的 read-view，只有在 read-view 中的数据对于改事务才是可见的。如果 c 的数据对该事务不可见，就找到上一个版本看是否可见，不可见就继续往上，如果一直没有，则认为该数据对该事务是不可见的。



在不需要的时候才删除。也就是说，系统会判断，当没有事务再需要用到这些回滚日志时，回滚日志会被删除。当系统里没有比这个回滚日志更早的read-view的时候。